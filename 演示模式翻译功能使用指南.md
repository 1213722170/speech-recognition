# 演示模式翻译功能使用指南

## 快速开始

### 运行程序
```bash
python voice_assistant.py
```

### 选择演示模式
程序会显示以下菜单：
```
╔═══════════════════════════════════════╗
║     Python 语音助手演示程序          ║
╚═══════════════════════════════════════╝

请选择演示模式:
1. 基础演示 - 单次语音识别
2. 唤醒词演示 - 等待唤醒词后识别
3. 持续监听 - 持续监听并处理命令
4. 翻译演示 - 语音识别并翻译成英文

请输入选择 (1/2/3/4):
```

---

## 演示模式详解

### 模式 1：基础演示（带翻译功能）

**功能说明：**
- 单次语音识别
- 可选择启用/不启用翻译
- 支持在线和离线翻译

**使用步骤：**
```
1. 输入：1
2. 选择翻译选项：
   - 1：在线翻译（需要网络，更准确）
   - 2：离线翻译（无需网络，常用词）
   - 3：不使用翻译（默认）
3. 开始说话
4. 查看识别和翻译结果
```

**示例输出（在线翻译）：**
```
🌐 已启用在线翻译模式
🎤 正在调整环境噪音...
🎤 请说话...
🔍 正在识别语音...
✅ 识别结果: 你好世界
🌐 正在翻译成英文 (使用 DeepTranslator)...
✅ 翻译结果: hello world

📝 最终结果:
   中文: 你好世界
   英文: hello world
```

**示例输出（离线翻译）：**
```
📚 已启用离线翻译模式
🎤 正在调整环境噪音...
🎤 请说话...
🔍 正在识别语音...
✅ 识别结果: 打开灯光
📚 使用离线词典翻译...
✅ 离线翻译结果: open light

📝 最终结果:
   中文: 打开灯光
   英文: open light
```

**示例输出（不使用翻译）：**
```
🎤 正在调整环境噪音...
🎤 请说话...
🔍 正在识别语音...
✅ 识别结果: 你好世界
最终结果: 你好世界
```

---

### 模式 2：唤醒词演示（带翻译功能）

**功能说明：**
- 等待唤醒词"你好"
- 唤醒后进行语音识别
- 可选择启用/不启用翻译
- 支持在线和离线翻译

**使用步骤：**
```
1. 输入：2
2. 选择翻译选项：
   - 1：在线翻译（需要网络，更准确）
   - 2：离线翻译（无需网络，常用词）
   - 3：不使用翻译（默认）
3. 说"你好"唤醒
4. 说出命令
5. 查看识别和翻译结果
```

**示例输出：**
```
🌐 已启用在线翻译模式
😴 等待唤醒词: '你好'
💡 提示: 按 Ctrl+C 退出
🎤 正在调整环境噪音...
🎤 请说话...
👂 听到: 你好
✅ 已唤醒!

现在可以说话了...
🎤 正在调整环境噪音...
🎤 请说话...
✅ 识别结果: 打开灯光
🌐 正在翻译成英文...
✅ 翻译结果: open the light

📝 命令:
   中文: 打开灯光
   英文: open the light
```

---

### 模式 3：持续监听（带翻译功能）

**功能说明：**
- 等待唤醒词"小助手"
- 持续监听用户命令
- 自动处理识别结果
- 可选择启用/不启用翻译
- 支持在线和离线翻译
- 说"退出"或"再见"结束

**使用步骤：**
```
1. 输入：3
2. 选择翻译选项：
   - 1：在线翻译（需要网络，更准确）
   - 2：离线翻译（无需网络，常用词）
   - 3：不使用翻译（默认）
3. 说"小助手"唤醒
4. 持续说出命令
5. 说"退出"或"再见"结束
```

**内置命令：**
- "你好" → 回复：你好！
- "时间" → 显示当前时间
- "天气" → 回复天气信息
- "退出"/"再见" → 结束程序

**示例输出：**
```
🌐 已启用在线翻译模式
😴 等待唤醒词: '小助手'
🎤 请说话...
👂 听到: 小助手
✅ 已唤醒!
🎧 进入持续监听模式...

🎤 请说话...
✅ 识别结果: 你好
🌐 正在翻译成英文...
✅ 翻译结果: hello
📢 处理命令: 你好
   英文翻译: hello
🤖 回复: 你好!

🎤 请说话...
✅ 识别结果: 时间
🌐 正在翻译成英文...
✅ 翻译结果: time
📢 处理命令: 时间
   英文翻译: time
🤖 回复: 现在是 14:35

🎤 请说话...
✅ 识别结果: 再见
👋 收到退出命令
```

---

### 模式 4：翻译演示（专门翻译）

**功能说明：**
- 专门用于演示翻译功能
- 必须启用翻译（在线或离线）
- 单次识别和翻译

**使用步骤：**
```
1. 输入：4
2. 选择翻译模式：
   - 1：在线翻译（默认）
   - 2：离线翻译
3. 开始说话
4. 查看识别和翻译结果
```

**示例输出：**
```
请选择翻译模式:
1. 在线翻译 (需要网络，更准确)
2. 离线翻译 (无需网络，仅支持常用词)
请选择 (1/2, 默认1): 1

🌐 使用在线翻译模式
🎤 正在调整环境噪音...
🎤 请说话...
✅ 识别结果: 你好世界
🌐 正在翻译成英文...
✅ 翻译结果: hello world

📝 最终结果:
   中文: 你好世界
   英文: hello world
```

---

## 翻译模式对比

### 在线翻译（选项 1）

**优点：**
✅ 翻译准确度高  
✅ 支持各种复杂句子  
✅ 词汇量丰富  
✅ 自动重试机制  
✅ 失败自动降级到离线模式  

**缺点：**
❌ 需要网络连接  
❌ 可能受代理影响（已自动处理）  
❌ 翻译速度较慢  

**适用场景：**
- 网络环境良好
- 需要准确翻译
- 复杂句子翻译

---

### 离线翻译（选项 2）

**优点：**
✅ 无需网络  
✅ 翻译速度快  
✅ 稳定可靠  
✅ 无隐私顾虑  

**缺点：**
❌ 仅支持常用词（30+ 词条）  
❌ 复杂句子翻译效果差  
❌ 词汇量有限  

**适用场景：**
- 无网络环境
- 简单命令翻译
- 快速响应需求
- 智能家居控制

**支持的词汇：**
```
常用词汇：
- 问候：你好、再见、谢谢
- 时间：今天、明天、昨天、早上、下午、晚上
- 家居：灯、灯光、空调、电视、窗户、门
- 操作：打开、关闭、开始、停止
- 其他：时间、天气、音乐、帮助
```

---

### 不使用翻译（选项 3）

**说明：**
- 仅进行语音识别
- 不进行翻译
- 保持原有功能

**适用场景：**
- 仅需语音识别
- 中文命令处理
- 节省处理时间

---

## 常见问题

### Q1：在线翻译失败怎么办？
**A：** 程序会自动：
1. 重试 3 次
2. 如果持续失败，自动切换到离线翻译
3. 显示降级提示

### Q2：离线翻译不支持的词怎么办？
**A：** 
- 程序会保留原文
- 提示"离线词典中未找到对应翻译"
- 建议使用在线翻译模式

### Q3：代理导致的 SSL 错误？
**A：** 
- 程序会自动禁用系统代理
- 翻译完成后自动恢复
- 无需手动干预

### Q4：如何添加离线词汇？
**A：** 编辑 `voice_assistant.py` 中的 `_init_offline_dict()` 方法：
```python
self.offline_dict = {
    # 添加你的词汇
    "新词": "new word",
    ...
}
```

### Q5：能否同时使用多个翻译引擎？
**A：** 
- 程序已内置双引擎支持
- 优先使用 DeepTranslator
- 失败后自动切换到 GoogleTrans
- 再失败则降级到离线模式

---

## 技术细节

### 翻译流程
```
用户说话
    ↓
语音识别
    ↓
识别成功？ → 否 → 返回 None
    ↓ 是
启用翻译？ → 否 → 返回文本
    ↓ 是
在线模式？ → 否 → 离线翻译
    ↓ 是
DeepTranslator 翻译
    ↓
成功？ → 是 → 返回字典 {'original', 'translation'}
    ↓ 否
GoogleTrans 翻译
    ↓
成功？ → 是 → 返回字典
    ↓ 否
离线翻译（降级）
    ↓
返回字典
```

### 容错机制
1. **网络层**：自动禁用代理避免 SSL 错误
2. **重试层**：失败自动重试 3 次
3. **降级层**：在线失败自动切换离线
4. **异常处理**：捕获所有异常并友好提示

---

## 最佳实践

### 推荐配置

**场景 1：家庭使用（网络稳定）**
```
演示模式：3（持续监听）
翻译选项：1（在线翻译）
```

**场景 2：无网环境（如车载）**
```
演示模式：3（持续监听）
翻译选项：2（离线翻译）
```

**场景 3：快速测试**
```
演示模式：1（基础演示）
翻译选项：1（在线翻译）
```

**场景 4：纯中文环境**
```
演示模式：1/2/3（任意）
翻译选项：3（不使用翻译）
```

---

## 更新日志

### v1.0 (2025-10-19)
- ✅ 演示模式 1 集成翻译功能
- ✅ 演示模式 2 集成翻译功能
- ✅ 演示模式 3 集成翻译功能
- ✅ continuous_listen 方法支持翻译结果
- ✅ 统一的翻译选项界面
- ✅ 完整的文档和示例

---

**祝使用愉快！** 🎉

如有问题，请参考 `翻译功能集成说明.md` 或查看源代码。
