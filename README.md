# 语音助手程序使用说明

## 📋 目录

- [项目简介](#项目简介)
- [功能特性](#功能特性)
- [环境要求](#环境要求)
- [安装步骤](#安装步骤)
- [快速开始](#快速开始)
- [详细操作指南](#详细操作指南)
- [命令说明](#命令说明)
- [常见问题](#常见问题)
- [技术说明](#技术说明)

---

## 项目简介

这是一个基于 Python 开发的智能语音助手程序，支持语音识别、唤醒词检测和在线翻译功能。程序可以将您说的中文实时识别并翻译成英文，适合语音控制、语音学习等场景。

### 核心功能

- **语音识别**：实时捕获并识别您的语音
- **唤醒词检测**：支持自定义唤醒词（默认："小助手"）
- **在线翻译**：将识别的中文翻译成英文
- **循环交互**：一问一答式的持续对话模式

---

## 功能特性

### ✅ 两种演示模式

1. **基础演示** - 单次语音识别
   - 运行一次，识别一次
   - 适合快速测试

2. **唤醒词循环** - 持续交互模式
   - 每次需要说唤醒词激活
   - 激活后识别一次命令
   - 自动休眠，等待下次唤醒
   - 类似 Siri、小爱同学的交互方式

### ✅ 翻译功能

- **在线翻译**：使用 Google 翻译引擎，准确度高
- **自动重试**：网络失败时自动重试 3 次
- **智能降级**：在线翻译失败时自动切换到离线词典
- **纯英文输出**：启用翻译后只显示英文结果

### ✅ 智能识别

- **动态阈值调整**：自动适应环境噪音
- **停顿检测优化**：1.5 秒停顿阈值，避免说话中途被打断
- **静默等待**：未唤醒时不输出识别内容，保护隐私

---

## 环境要求

### 操作系统

- Windows 10/11
- macOS 10.14+
- Linux (Ubuntu 18.04+)

### Python 版本

- Python 3.7 或更高版本

### 硬件要求

- 麦克风（必需）
- 网络连接（翻译功能需要）

---

## 安装步骤

### 1. 克隆或下载项目

```bash
git clone <项目地址>
cd <项目目录>
```

### 2. 安装 Python 依赖

#### 通用安装方法

```bash
pip install -r requirements.txt
```

#### Windows 用户特别说明

由于 PyAudio 在 Windows 上编译较复杂，推荐使用以下方法：

**方法一：使用 pipwin**
```bash
pip install pipwin
pipwin install pyaudio
pip install -r requirements.txt
```

**方法二：下载预编译包**
1. 访问 https://www.lfd.uci.edu/~gohlke/pythonlibs/#pyaudio
2. 下载对应 Python 版本的 .whl 文件
3. 安装：`pip install PyAudio-xxx.whl`

#### macOS 用户

```bash
brew install portaudio
pip install -r requirements.txt
```

#### Linux 用户

```bash
sudo apt-get install portaudio19-dev python3-pyaudio
pip install -r requirements.txt
```

### 3. 安装翻译库（可选但推荐）

```bash
pip install deep-translator googletrans==3.1.0a0
```

### 4. 验证安装

```bash
python voice_assistant.py
```

如果看到主菜单，说明安装成功！

---

## 快速开始

### 第一次使用

1. **打开终端/命令提示符**
   ```bash
   cd <项目目录>
   python voice_assistant.py
   ```

2. **选择演示模式**
   ```
   请选择演示模式:
   1. 基础演示 - 单次语音识别
   2. 唤醒词循环 - 每次唤醒后识别一次命令
   
   请输入选择 (1/2): 2
   ```

3. **选择是否启用翻译**
   ```
   是否启用翻译功能？
   1. 是（在线翻译）
   2. 否
   请选择 (1/2, 默认2): 1
   ```

4. **开始使用**
   ```
   等待唤醒词: '小助手'...
   ```
   此时说"小助手"即可唤醒

5. **说出命令**
   ```
   已唤醒
   ```
   唤醒后说出您的命令，例如"你好"

6. **查看结果**
   ```
   hello
   ```
   程序会输出英文翻译结果

---

## 详细操作指南

### 模式一：基础演示

**适用场景：** 快速测试、单次查询

**操作步骤：**

1. 运行程序并选择模式 1
   ```bash
   python voice_assistant.py
   请输入选择 (1/2): 1
   ```

2. 选择是否启用翻译
   ```
   是否启用翻译功能？
   1. 是（在线翻译）
   2. 否
   请选择 (1/2, 默认2): 1
   ```

3. 程序提示后开始说话
   ```
   已启用翻译模式
   
   🎤 正在调整环境噪音...
   🎤 请说话...
   ```

4. 说出您的内容
   - 例如："你好世界"
   - 等待 1.5 秒确保说完

5. 查看结果
   ```
   🔍 正在识别语音...
   ✅ 识别结果: 你好世界
   🌐 正在翻译成英文 (使用 DeepTranslator)...
   ✅ 翻译结果: hello world
   
   hello world
   ```

6. 程序自动结束

**注意事项：**
- 程序只运行一次
- 说话时保持清晰
- 说完后等待 1.5 秒让程序识别

---

### 模式二：唤醒词循环

**适用场景：** 持续使用、多轮对话

**操作步骤：**

#### 启动程序

1. 运行程序并选择模式 2
   ```bash
   python voice_assistant.py
   请输入选择 (1/2): 2
   ```

2. 选择是否启用翻译
   ```
   是否启用翻译功能？
   1. 是（在线翻译）
   2. 否
   请选择 (1/2, 默认2): 1
   ```

3. 程序进入等待状态
   ```
   已启用翻译模式
   每次唤醒后只识别一次
   Ctrl+C 退出
   
   等待唤醒词: '小助手'...
   ```

#### 使用流程

**第一轮交互：**

1. **说唤醒词**
   - 您说："小助手"
   - 程序识别到唤醒词（不显示）

2. **程序唤醒**
   ```
   已唤醒
   
   🎤 请说话...
   ```

3. **说出命令**
   - 您说："你好"
   - 等待程序识别和翻译

4. **查看结果**
   ```
   ✅ 识别结果: 你好
   🌐 正在翻译成英文...
   ✅ 翻译结果: hello
   
   hello
   
   ```

5. **自动休眠**
   ```
   等待唤醒词: '小助手'...
   ```
   程序自动回到等待状态

**第二轮交互：**

重复上述步骤：
- 说"小助手" → 唤醒
- 说命令 → 识别翻译
- 自动休眠 → 等待下次唤醒

#### 退出程序

**方法一：** 说退出命令
- 唤醒后说："再见" 或 "退出"
- 程序会显示"程序结束"并退出

**方法二：** 强制退出
- 按 `Ctrl+C`
- 程序会显示"程序已退出"

---

## 命令说明

### 系统命令

| 命令 | 说明 | 示例 |
|------|------|------|
| 小助手 | 唤醒词，激活程序 | "小助手" |
| 再见 | 退出程序 | "再见" |
| 退出 | 退出程序 | "退出" |

### 支持的中文输入

程序可以识别任何中文语音输入，例如：

- 问候语："你好"、"早上好"、"晚安"
- 查询类："时间"、"天气"、"日期"
- 命令类："打开灯"、"关闭音乐"
- 陈述句："今天天气很好"、"我要去吃饭"
- 任意中文句子

### 翻译输出

启用翻译后，所有识别到的中文都会翻译成英文输出。

**示例：**

| 您说的话 | 输出结果 |
|---------|---------|
| 你好 | hello |
| 今天天气很好 | the weather is very good today |
| 我想学英语 | i want to learn english |
| 打开灯光 | turn on the light |
| 现在几点了 | what time is it now |

---

## 常见问题

### Q1: 程序无法识别我的声音？

**可能原因：**
- 麦克风未正确连接
- 麦克风权限未开启
- 环境噪音太大

**解决方法：**
1. 检查麦克风是否正常工作
2. Windows：设置 → 隐私 → 麦克风 → 允许应用访问
3. macOS：系统偏好设置 → 安全性与隐私 → 麦克风
4. 尝试靠近麦克风说话
5. 减少环境噪音

### Q2: 识别总是在我说话中途就结束？

**原因：** 停顿检测阈值设置问题

**解决方法：**
程序已将停顿阈值设置为 1.5 秒。如果还是太快，可以修改代码：

打开 `voice_assistant.py`，找到：
```python
self.recognizer.pause_threshold = 1.5  # 语音暂停阈值(秒)
```

改为更大的值：
```python
self.recognizer.pause_threshold = 2.0  # 改为2秒
```

### Q3: 翻译功能不工作？

**可能原因：**
- 没有安装翻译库
- 网络连接问题
- 代理设置冲突

**解决方法：**

1. **安装翻译库**
   ```bash
   pip install deep-translator googletrans==3.1.0a0
   ```

2. **检查网络**
   - 确保可以访问 Google 服务
   - 检查防火墙设置

3. **禁用代理**
   - 程序会自动尝试禁用系统代理
   - 如果仍有问题，手动关闭代理软件

4. **使用离线模式**
   - 程序会自动降级到离线翻译
   - 支持常用词汇的简单翻译

### Q4: 程序识别内容不准确？

**解决方法：**

1. **说话清晰**
   - 发音标准
   - 语速适中
   - 避免方言

2. **环境安静**
   - 减少背景噪音
   - 关闭音乐、电视

3. **麦克风距离**
   - 保持 20-30cm 距离
   - 不要太远或太近

4. **网络稳定**
   - 使用稳定的网络
   - 避免网络波动

### Q5: 如何修改唤醒词？

打开 `voice_assistant.py`，找到：
```python
assistant = VoiceAssistant(wake_word="小助手", ...)
```

改为：
```python
assistant = VoiceAssistant(wake_word="你好", ...)  # 改为"你好"
```

### Q6: 未唤醒时说话会被识别吗？

**不会。** 程序已优化为：
- 等待唤醒词时：静默监听，不显示识别内容
- 只有说出唤醒词后才会激活
- 保护您的隐私

### Q7: 翻译结果为什么只显示英文？

这是程序设计的特性：
- **启用翻译时**：只显示英文翻译结果
- **不启用翻译时**：显示中文识别结果

如果需要同时显示中英文，可以修改代码。

### Q8: 程序可以离线使用吗？

**部分功能可以：**
- ✅ 语音识别：需要网络（使用 Google API）
- ❌ 在线翻译：需要网络
- ✅ 离线翻译：不需要网络（但词汇量有限）

**离线使用建议：**
- 不启用翻译功能
- 或使用离线翻译（仅支持常用词）

---

## 技术说明

### 核心技术栈

```
语音助手
├── 语音识别: SpeechRecognition 3.10.0
├── 音频捕获: PyAudio 0.2.14
├── 在线翻译: deep-translator / googletrans
├── 数据处理: NumPy 1.24.3
└── 离线识别: PocketSphinx 5.0.3
```

### 工作原理

```
用户说话
    ↓
麦克风捕获音频
    ↓
PyAudio 实时录音
    ↓
SpeechRecognition 识别
    ↓
Google API 转文字
    ↓
检查是否是唤醒词
    ↓ 是
进入命令识别模式
    ↓
识别命令内容
    ↓
翻译成英文（可选）
    ↓
输出结果
    ↓
自动休眠
```

### 识别参数

| 参数 | 值 | 说明 |
|------|-----|------|
| 能量阈值 | 4000 | 判断是否有声音 |
| 停顿阈值 | 1.5秒 | 多久静音算说完 |
| 录音超时 | 5秒 | 等待说话的时间 |
| 最长录音 | 10秒 | 单次最长说话时间 |

### 翻译机制

**三级容错：**
1. DeepTranslator（优先）
2. GoogleTrans（备选）
3. 离线词典（降级）

**特点：**
- 自动重试 3 次
- 网络失败自动降级
- 智能代理处理
- SSL 错误处理

### 性能优化

- **动态阈值**：自动适应环境噪音
- **智能等待**：优化停顿检测
- **异步处理**：提高响应速度
- **资源管理**：及时释放音频资源

---

## 使用技巧

### 💡 提高识别准确度

1. **清晰发音**
   - 字正腔圆
   - 语速适中（不要太快）
   - 避免吞音

2. **环境控制**
   - 安静的环境
   - 关闭风扇、空调等噪音源
   - 选择隔音好的房间

3. **麦克风设置**
   - 使用质量好的麦克风
   - 调整麦克风增益
   - 保持合适距离

4. **说话技巧**
   - 一句话连贯说完
   - 避免频繁停顿
   - 说完等待 1.5 秒

### 💡 高效使用翻译

1. **选择合适模式**
   - 快速测试 → 基础演示
   - 持续使用 → 唤醒词循环

2. **网络优化**
   - 使用稳定的 WiFi
   - 避免网络高峰期
   - 关闭其他占网络的应用

3. **内容准备**
   - 先想好要说什么
   - 避免太复杂的句子
   - 专业术语可能翻译不准

### 💡 自定义扩展

程序支持自定义扩展，例如：

1. **添加更多命令**
   - 编辑 `demo_continuous()` 函数
   - 添加命令检测逻辑

2. **修改唤醒词**
   - 改为"你好"、"嘿"等
   - 支持任意中文词汇

3. **集成智能家居**
   - 识别命令后调用智能家居 API
   - 实现语音控制灯光、空调等

---

## 更新日志

### v6.0 (2025-10-19)
- ✅ 优化输出格式，只显示英文翻译
- ✅ 移除所有表情符号和装饰性提示
- ✅ 未唤醒时不输出识别内容
- ✅ 提高停顿检测阈值到 1.5 秒

### v5.0 (2025-10-19)
- ✅ 改为唤醒词循环模式
- ✅ 每次唤醒后只识别一次
- ✅ 自动休眠机制

### v4.0 (2025-10-19)
- ✅ 删除演示模式 2（唤醒词演示）
- ✅ 简化为两个演示模式

### v3.0 (2025-10-19)
- ✅ 删除离线翻译用户选项
- ✅ 保留自动降级机制

---

## 许可证

本项目遵循 MIT 许可证。

---

## 联系方式

如有问题或建议，欢迎联系：
- 项目地址：[GitHub 链接]
- 问题反馈：[Issues 链接]

---

## 致谢

感谢以下开源项目的支持：
- SpeechRecognition
- PyAudio
- deep-translator
- Google Speech API

---

**最后更新时间**: 2025-10-19  
**版本**: 6.0  
**作者**: [作者名称]
